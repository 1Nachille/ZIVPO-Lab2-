# Лабораторная №2
Список найденных уязвимостей с 2022 по 2025 год
1. __RCE__ уязвимости:
    - [Уязвимость git (CVE-2024-32002)](https://redos.red-soft.ru/support/secure/uyazvimosti/uyazvimost-git-cve-2024-32002/)
    - [Уязвимость произвольного выполнения кода IPv6-пакетов в TCP/IP-стеке Windows (CVE-2024-38063)](https://cncso.com/ru/cve-2024-38063-0-click-rce-%D0%B7%D0%B0%D1%82%D1%80%D0%B0%D0%B3%D0%B8%D0%B2%D0%B0%D0%B5%D1%82-%D0%B2%D1%81%D0%B5-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B-windows-html)
    - [Уязвимость, связанная с некорректным управлением доступом, существует в SMB-клиенте операционных систем семейства Windows (CVE-2025-33073)](https://ptsecurity.com/research/trending-vulnerabilities/CVE-2025-33073/)
    - [Уязвимость в Microsoft SharePoint Server, связанная с небезопасной десериализацией данных (CVE-2025-53770)](https://ptsecurity.com/research/trending-vulnerabilities/CVE-2025-53770/)
    - [Уязвимость в службе обновления операционных систем семейства Windows (CVE-2025-48799)](https://ptsecurity.com/research/trending-vulnerabilities/CVE-2025-48799/)
2. __LPE__ уязвимости:
    - [Уязвимость kernel-lt (CVE-2024-1086)](https://redos.red-soft.ru/support/secure/uyazvimosti/uyazvimost-kernel-lt-cve-2024-1086/)
    - [Локальная уязвимость в nftables, позволяющая повысить свои привилегии (CVE-2022-34918)](https://www.opennet.ru/opennews/art.shtml?num=57445)
    - [Уязвимость, позволяющая повысить привилегии до уровня SYSTEM для Windows 10 (CVE-2022-21882)](https://habr.com/ru/news/648563/)
    - [Linux LPE через Needrestart (CVE-2024-48990)](https://habr.com/ru/articles/866582/)
    - [Уязвимость libblockdev (CVE-2025-6019)](https://redos.red-soft.ru/support/secure/uyazvimosti/uyazvimost-libblockdev-cve-2025-6019/)
## Анализ 2 RCE и 2 LPE уязвимостей
Для разбора я выбрал CVE-2024-32002 и CVE-2024-38063 для RCE, CVE-2024-48990 и CVE-2022-21882 для LPE.
### CVE-2024-32002
CVE-2024-32002 — уязвимости в Git, допускающей RCE во время операции клонирования `git clone`. Создавая репозитории с подмодулями определённым образом, злоумышленник может использовать обработку символических ссылок в файловых системах, нечувствительных к регистру, для записи файлов в каталог `.git/`, что приведёт к выполнению вредоносных хуков.
#### Принцип работы    
1. Вредоносный репозиторий (`git_rce`) включает подмодуль со специально созданным путем.
2. Путь к подмодулю использует вариацию регистра, которая использует файловую систему, нечувствительную к регистру.
3. Подмодуль включает символическую ссылку, указывающую на его каталог `.git/`, который содержит вредоносный хук.
4. При клонировании репозитория происходит переход по символической ссылке и выполнение вредоносного хука, что приводит к RCE.
### CVE-2024-38063
Уязвимость кроется в обработке пакетов IPv6 в TCP/IP-стеке Windows. Неавторизованный злоумышленник может использовать эту уязвимость, отправляя специально созданные пакеты IPv6 на целевую систему, что приводит к удаленному выполнению кода (Remote Code Execution, RCE). Такие атаки позволяют злоумышленнику выполнить произвольный код на пораженной системе и, возможно, получить полный контроль над ней.
CVE-2024-38063 особенно опасна тем, что не требует вмешательства пользователя или специальных разрешений, что делает вероятность ее использования очень высокой. Microsoft выпустила исправление, и пользователям необходимо убедиться, что их системы обновлены.
#### Влияние уязвимости
Эта уязвимость в настоящее время затрагивает все системы windows с включенным IPV6. Уязвимость существует в TCP/IP, который, как известно, является фундаментальным набором протоколов, лежащих в основе Интернета. TCP/IP облегчает связь между различными сетями, и любое нарушение или эксплуатация этого основного компонента может иметь широкомасштабные последствия.
Хотя на данный момент CVE-2024-38063 активно не эксплуатируется, ее потенциал для нанесения ущерба весьма значителен. Microsoft классифицировала эту уязвимость как "более вероятную" для эксплуатации, что означает, что она может стать целью для угроз, позволяющих скомпрометировать системы с минимальными усилиями. Низкая сложность атаки и отсутствие взаимодействия с пользователем делают уязвимость привлекательной для злоумышленников.
### CVE-2024-48990
CVE-2024-48990 возникает из-за уязвимости в обработке переменных окружения утилитой Needrestart, используемой в Linux для проверки и перезапуска сервисов после обновления библиотек. Проблема связана с тем, что утилита до версии 3.8 некорректно обрабатывает переменную PYTHONPATH. Это позволяет локальному атакующему указать поддельный путь для Python-интерпретатора, что может привести к выполнению произвольного кода с привилегиями root.
Ошибка стала возможной из-за недостаточного контроля содержимого переменных окружения, используемых для настройки путей загрузки модулей интерпретаторов (Python, Perl, Ruby). Это делает утилиту уязвимой к манипуляциям со стороны локальных пользователей, которые могут подменить пути на вредоносные библиотеки или скрипты.
Чтобы проверить уязвима ли ваша система можно выполнить команду:
`needrestart --version | grep -q "3.7" && echo "Definitely vulnerable" || echo "Version is potentially not vulnerable, this simply checks for 3.7"`
В заключение, CVE-2024-48990 демонстрирует, как эксплуатация уязвимости в системной утилите может привести к серьезным последствиям, таким как получение прав root и доступ к конфиденциальным данным.
### CVE-2022-21882
По информации Bleeping Computer, разработчик KaLendsi опубликовал на GitHub рабочий LPE-эксплойт на уязвимость для Windows 10 CVE-2022-21882. С его помощью локальный пользователь с ограниченными правами может повысить привилегии до уровня SYSTEM.
Данная уязвимость закрыта в январском выпуске обновлений безопасности Microsoft. Уязвимости подвержены все поддерживаемые версии Windows 10, в Windows 11 эксплойт не работает. В настоящее время многие системные администраторы так и не поставили еще январские патчи из-за в ошибок и проблем с некоторыми патчами там — у многих системы начали перезагружаться нештатно, возникли проблемы при работе L2TP VPN и Hyper-V.
ИБ-эксперты подтвердили, что LPE-эксплойт на уязвимость CVE-2022-21882 действительно работает. Они настоятельно советуют обновить пользовательские системы с помощью последних патчей от Microsoft.
Эксперты Bleeping Computer проверили работоспособность эксплойта и выяснили, что с его помощью действительно можно за несколько секунд локально получить обычным пользователем права администратора системы на Windows 10 21H1 build 19043.1348. С помощью этого эксплойта локально злоумышленники также могут добавлять новых пользователей с правами администратора в систему или выполнять другие привилегированные команды.
Уязвимость CVE-2022-21882 обнаружил и передал по ней всю информацию в Microsoft разработчик RyeLv из команды Google Project Zero. В своем блоге он провел технический анализ уязвимости после того, как Microsoft выпустила против нее патч.
